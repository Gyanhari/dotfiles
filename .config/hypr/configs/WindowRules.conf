# === 1. AESTHETICS (OPACITY & BLUR) ===
# Using lower opacity to let the heavy blur defined in Decorations.conf shine through.
# Terminals - Versatile Tiled Terminal (0.9 opacity)
windowrulev2 = opacity 0.90 0.90, class:^(kitty)$
windowrulev2 = opacity 0.90 0.90, class:^(alacritty)$

# Text Editors / IDEs (Slightly less transparent for readability)
windowrulev2 = opacity 0.92 0.92, class:^(Code)$
windowrulev2 = opacity 0.92 0.92, class:^(codium-url-handler)$
windowrulev2 = opacity 0.92 0.92, class:^(jetbrains-.+)$

# Communication & Media (Glassy look)
windowrulev2 = opacity 0.90 0.90, class:^(discord)$
windowrulev2 = opacity 0.90 0.90, class:^(Spotify)$
windowrulev2 = opacity 0.90 0.90, class:^(vesktop)$

# File Managers
windowrulev2 = opacity 0.85 0.85, class:^(thunar)$
windowrulev2 = opacity 0.85 0.85, class:^(nemo)$
windowrulev2 = opacity 0.85 0.85, class:^(org.kde.dolphin)$


# === 2. FLOATING "HUD" WINDOWS (System Panels) ===
windowrulev2 = float, class:^(pavucontrol)$
windowrulev2 = size 800 600, class:^(pavucontrol)$
windowrulev2 = center, class:^(pavucontrol)$

windowrulev2 = float, class:^(blueman-manager)$
windowrulev2 = size 800 600, class:^(blueman-manager)$

windowrulev2 = float, class:^(nm-connection-editor)$

windowrulev2 = float, class:^(org.kde.polkit-kde-authentication-agent-1)$
windowrulev2 = dimaround, class:^(org.kde.polkit-kde-authentication-agent-1)$

# Image and Video Viewers should float by default
windowrulev2 = float, class:^(eog)$
windowrulev2 = float, class:^(imv)$
windowrulev2 = float, class:^(vlc)$
windowrulev2 = float, class:^(mpv)$


# === 3. FLOATING SCRATCHPAD TERMINAL (Keybind triggered) ===
windowrulev2 = float, title:^(scratchpad)$
windowrulev2 = size 800 500, title:^(scratchpad)$
windowrulev2 = center, title:^(scratchpad)$
windowrulev2 = pin, title:^(scratchpad)$
windowrulev2 = opacity 1.0 override 1.0 override, title:^(scratchpad)$
windowrulev2 = bordercolor rgb(00ff9c) override, title:^(scratchpad)$

# ALWAYS send kitty scratchpad to special workspace
windowrulev2 = workspace special:scratchpad, title:^(scratchpad)$


# === 4. PICTURE-IN-PICTURE (PiP) TWEAKS ===
# Makes PiP videos stick to the bottom-right corner and uses a cyan border.
windowrulev2 = float, title:^(Picture-in-Picture)$
windowrulev2 = pin, title:^(Picture-in-Picture)$
windowrulev2 = move 100%-w-20 100%-h-20, title:^(Picture-in-Picture)$
windowrulev2 = size 40% 40%, title:^(Picture-in-Picture)$
windowrulev2 = noinitialfocus, title:^(Picture-in-Picture)$
windowrulev2 = opacity 1.0 1.0, title:^(Picture-in-Picture)$
windowrulev2 = bordercolor rgb(00e8ff), title:^(Picture-in-Picture)$ 


# === 5. WORKFLOW AUTOMATION (Tiled Apps) ===
# Versatile Terminal is NOT locked to a workspace.
windowrulev2 = workspace 1, class:^(firefox)$
windowrulev2 = workspace 1, class:^(google-chrome)$
windowrulev2 = workspace 1, class:^(brave-browser)$

windowrulev2 = workspace 2, class:^(Code)$
windowrulev2 = workspace 2, class:^(jetbrains-.+)$

windowrulev2 = workspace 4, class:^(discord)$
windowrulev2 = workspace 4, class:^(vesktop)$

windowrulev2 = workspace 5, class:^(Spotify)$
windowrulev2 = workspace 6, class:^(steam)$


# === 6. GAME/UTILITY FIXES ===
windowrulev2 = idleinhibit fullscreen, class:^(firefox)$
windowrulev2 = idleinhibit fullscreen, class:^(google-chrome)$

# Steam Fixes
windowrulev2 = float, class:^(steam)$, title:^(Friends List)$
windowrulev2 = float, class:^(steam)$, title:^(Steam - News)$
windowrulev2 = float, class:^(steam)$, title:^(.*Settings.*)$
windowrulev2 = stayfocused, title:^()$,class:^(steam)$
windowrulev2 = minsize 1 1, title:^()$,class:^(steam)$

# Screen Sharing Fix (xwaylandvideobridge)
windowrulev2 = opacity 0.0 override 0.0 override,class:^(xwaylandvideobridge)$
windowrulev2 = noanim,class:^(xwaylandvideobridge)$
windowrulev2 = noinitialfocus,class:^(xwaylandvideobridge)$
windowrulev2 = maxsize 1 1,class:^(xwaylandvideobridge)$
windowrulev2 = noblur,class:^(xwaylandvideobridge)$

# -----------------------------------------------------
# === 7. LAYOUT & TILING TWEAKS (Dwindle/Master) ===
# -----------------------------------------------------

# Ignore maximize requests from apps. Essential for Dwindle/Master layouts
# to prevent apps from acting like they are in a normal DE.
windowrulev2 = suppressevent maximize, class:.*

# Fix XWayland apps sometimes creating invisible windows that steal focus
windowrulev2 = nofocus,class:^$,title:^$,xwayland:1,floating:1,fullscreen:0,pinned:0

# === PSEUDOTILING (The "Cyberpunk Data-Pad" Look) ===
# 'pseudotile' makes a window keep its original size while being part of the tile grid.
# Great for calculators, color pickers, or small tools so they don't stretch across the screen.
windowrulev2 = float, class:^(org.kde.kcalc)$
windowrulev2 = float, class:^(galculator)$
windowrulev2 = float, class:^(hyprland-share-picker)$
windowrulev2 = float, class:^(lxqt-policykit-agent)$

# === DIALOGS & MENUS ===
# Ensure file dialogs and context menus don't get tiled or blurred weirdly
windowrulev2 = float, title:^(Open File)$
windowrulev2 = float, title:^(Select a File)$
windowrulev2 = float, title:^(Choose wallpaper)$
windowrulev2 = float, title:^(Open Folder)$
windowrulev2 = float, title:^(Save As)$
windowrulev2 = float, title:^(Rename)$
windowrulev2 = float, title:^(Enter the new name)$
windowrulev2 = float, title:^(Library)$
windowrulev2 = float, title:^(File Operation Progress)$
windowrulev2 = float, initialclass:^(Thunar)$, title:^(Rename)
windowrulev2 = center, title:^(Open File)$
windowrulev2 = center, title:^(Save As)$

# Only floating windows get the "neon glow" shadow
windowrulev2 = noshadow, floating:0

# Make menus opaque (readable) even if the app is transparent
windowrulev2 = opacity 1.0 override 1.0 override, title:^(.*Menu.*)$
windowrulev2 = opacity 1.0 override 1.0 override, title:^(.*Popup.*)$
windowrulev2 = noblur, title:^(.*Menu.*)$

# XWayland Video Bridge (Screen sharing fix specific rules)
# This ensures the bridge is invisible and doesn't mess up your layout
windowrulev2 = opacity 0.0 override 0.0 override, class:^(xwaylandvideobridge)$
windowrulev2 = noanim, class:^(xwaylandvideobridge)$
windowrulev2 = noinitialfocus, class:^(xwaylandvideobridge)$
windowrulev2 = maxsize 1 1, class:^(xwaylandvideobridge)$
windowrulev2 = noblur, class:^(xwaylandvideobridge)$

